/********************************************************************/
/*     大貧民サーバー tndhms version 0.32   (2010/11/19)            */
/*     （第5回 UEC コンピュータ大貧民大会 UECda-2010 仕様 対応版）  */
/********************************************************************/

◎概要
  第5回 UEC コンピュータ大貧民大会（UECda-2010）の仕様に対応した大貧民
サーバーです。ゲームを行なうのに最低限必要な機能は実装されています。な
お、UECda-2010の仕様はUECda-2009,2008,2007の仕様と同一ですので、以前の
大会のクライアントも対戦させることができます。
  また、UECda-2006 のプロトコルにも対応しています。UECda-2007 と 
UECda-2006 のルールは、基本的に同じであるため、UECda-2007用プロトコル
のクライアントと UECda-2006用プロトコルのクライアントが混在しても対戦
できます。ただし、UECda-2006用クライアントは、サーバーと同じ種類のCPU
上で動作させてください。

◎実行環境
  c のコンパイル環境、並びに X11 の開発環境と libXpm が必須です。条件
を満たしていれば、大抵の環境で動くと思います。開発担当の西野研では、
    Solaris 8
    Solaris 10 （x86 and sparc）
    FreeBSD 6.0
    FreeBSD 6.1
    KNOPPIX 5.0.1
    cygwin
でコンパイルが通ることを確認しています。

◎コンパイルと実行について
  付属の INSTALL.txt をご覧下さい。

◎使用方法
  tndhms [-vh] [-p port_number]
    -v バージョン情報を表示します。

    -h ヘルプを表示します。

    -p port_number 通信に使用するport番号を指定します。
       指定しないと 42485 が使用されます。

    -c config file を指定します。
       指定しないと実行したディレクトリにある tndhm.cfg が使用されます。

◎再配布に関して
  改変したものを配布するのは自由ですが、その場合、オリジナルのパッケー
ジも付属してください。また、改変したものがオリジナルではないことがわか
るようにしてください。

◎免責
  本ソフトウェアを使用した上で生じたいかなる損害についても、UEC コンピュー
タ大貧民大会実行委員会ならびに西野研究室は責任を負いません。

◎更新履歴
・2013/11/20   Ver.0.37
    革命時の顔画面がたまごしか出ないバグを修正
・2013/11/20   Ver.0.36
    0.32fc2相当の機能を統合。それに伴い、HIDDEN_NAMEオプションを追加。
・2013/11/19   Ver.0.35
    統計情報をオプション化
・2012/11/01   Ver.0.34
    革命時の階段判定の不備を修正
・2011/11/01   Ver.0.33
    ジョーカー後のスペ3のとき、カード保持をチェックしないバグを修正
・2010/11/17   Ver.0.32
    new_alice で、一部の画像が古かったのを修正。
・2010/11/17   Ver.0.31
    UECda-2010用に公開するため、README.txt を書き換えた。
    画面モードに new_alise が追加された。
・2009/10/16   Ver.0.30+
    UECda-2009用に公開するため、README.txt を書き換えた。
・2008/11/21   Ver.0.30
    new_normal に画面効果を修正。
    UECda-2008大会当日で使用したバージョン。
・2008/11/21   Ver.0.29
    new_normal に画面効果を追加。
・2008/11/21   Ver.0.28
    新しい画面モード new_normal を追加した。
    グラフのモードが2通りになった（new_normalのみ）。
・2007/11/15   Ver.0.27
    カードを配る順番を、席順に合わせた。
    席替え実装時に発生した『カード交換時に通知される各自が持っているカー
  ド枚数が間違っている』バグを修正。
    グラフ線画のベータ版のプログラムがマージされた。
・2007/11/13   Ver.0.26
    席替えを実装した。
・2007/09/15   Ver.0.25
    2006年度プロトコルのバグを修正。
    XPM ファイルの場所を config ファイル内で指定できるようにした。
    tndhm.cfgで指定しているport番号を、標準クライアントに合わせた    
    乱数としてメルセンヌツイスタも利用できるようにした
    knoppix用バイナリの同梱をやめた。
・2007/08/31   Ver.0.24
    席換え以外の2007年度のプロトコルに対応した。
・2007/05/20  Ver.0.23
    config file を指定するオプションをつけた
    カード交換の部分のルーチンをシンプルにした
    画像ファイルの読み込み部分をシンプルにした
・2007/03/10  Ver.0.22
    身分のリセットなしという設定をできるようにした
・2006/11/29  Ver.0.21
    カード交換をしないフラグ RULE_CHANGE を追加。デフォルトは YES。
    X関係の命令を external.c から xdaihu.c に分離した。
・2006/11/18  Ver.0.20
    初回分の身分の通知を平民に
    身分をリセットする機能を追加（FLASH_MIBUN_NUMBER）
    カード交換のとき、ジョーカーまわりのバグを修正
    身分リセット後のカードを配り始める起点の決定に乱数を降るように。
    ゲーム終了後に止めるようにした
    プレイヤーの名前が点滅する問題を解消
    場にカードがないとき、メッセージを出るようにした
    カード交換中に、メッセージが出るようにした
・2006/11/16  Ver.0.19
    WINDOW_TYPE に middle_xga を追加。middle_extend の XGA 版。
    GRAPH_WINDOW の yes を廃止して、big に変更。
    GRAPH_WINDOW に middle を追加。
    control_win の使用を変更した。
    ターンの回り方のルーチン部分を書き換えた。
・2006/11/14  Ver.0.18
    0.17 にあった、グラフを出さないと、WINDOW 全般が落ちるバグを直した。
    analyze_cards 内で、error のフラグを落さないようにした。
    joker 単騎で切れたとき、カードが画面上の謎のところに出るバグを修正。
    しばりの時に、joker がスート指定でないと出せないバグを修正。
    単騎の joker が、8 の代りになるバグを修正。
    大富豪がカード交換の時に joker を2枚出そうとするときに起きるバグを修正。
    WINDOW_TYPE に middle_extend を追加。
・2006/11/14  Ver.0.17
    グラフと共に、過去10回の平均点を出力するようにした。
    tndhms.cfg で、クライアントの名前を指定できるようにした。
・2006/11/14  Ver.0.16
    今度こそ、WINDOW_TYPE に MIDDLE が完成した（つもり）。
・2006/11/13  Ver.0.15
    マイナーバージョンアップ
    ソースを整理して、すべての大域変数をなくした。
・2006/11/12  Ver.0.14
    はじめにグラフの縦軸と横軸に文字を書くようにした。
    WINDOW_TYPE に MIDDLE を追加した。
    0.13 で直したバグの修正方法の変更。
・2006/11/11  Ver.0.13
    グラフの縦軸と横軸に文字をうった。
    しばられていると、joker の上にスペ3が出ないバグを修正。
・2006/11/10  Ver.0.12
    cygwin でも設定ファイルを読めるようになった（改行コードの辻褄合わせ）
    簡易的なグラフを書けるようにした。
・2006/11/08  Ver.0.11
    rule.h を廃止。
    tndhms.cfg を読むようになった。
・2006/11/05  Ver.0.10a
    drop_card_flag の、Joker 勝手にが無くなってしまう場合があるバグを修正。
    このバグは広松悠介様からご連絡頂きました。ありがとうございました。
・2006/11/01  Ver.0.10
    『千日手になったとき、ランダムに順位を決定する』仕様に対応。
    使用する port 番号を、オプションで指定できるようにした。
・2006/10/14  Ver.0.09
    xmkmf 使用でもコンパイルできるように復元した。
    第1回 UEC コンピュータ大貧民大会 UECda-2006 の仕様に対応。
    外部にソースを公開。
・2006/10/13  Ver.0.08 
    backing store が有効でない X11 でも、とりあえず動作するように修正。
・2006/07/19  Ver.0.07 
    最低限の仕様が実装された。
    オープンキャンパス用リリース
